<!DOCTYPE html>
<html>
<head>
	<title>Notas</title>
	<link rel="stylesheet" href="style.css">
	<link href="https://fonts.googleapis.com/css?family=Roboto+Slab" rel="stylesheet">
	<style type="text/css">
		pre {outline: 1px solid #ccc; padding: 5px; margin: 5px; }
		.string { color: green; }
		.number { color: darkorange; }
		.boolean { color: blue; }
		.null { color: magenta; }
		.key { color: red; }


		.card-info{
			padding: 13px;
		}

		p{
			word-wrap: break-word;
		}

		*{
			font-family: 'Roboto Slab', serif;
		}

		textarea{
			padding: 10px;
			width: 100%;
		}

		button {
			background-color:#0a7efa;
			-moz-border-radius:12px;
			-webkit-border-radius:12px;
			border-radius:12px;
			display:inline-block;
			border:5px solid #337fed;
			cursor:pointer;
			color:#ffffff;
			font-family:Arial;
			font-size:19px;
			font-weight:bold;
			padding:12px 12px;
			text-decoration:none;
			width: 250px;
		}

		.card-title{
			font-weight : bold;
			text-align: center;
			margin-bottom: 12px;
		}

	</style>
</head>
<body>
	<div class="flex-container">
		<textarea name="Text1" cols="60" rows="10" id="jsonData" placeholder="Plase here your Notas backup content">[{
    "id": 57,
    "title": "",
    "text": "No sé qué hora te puedo decir que no te recomiendo de nuevo tus comentarios saludos cordiales ING en tu casa a las fotos del evento y la otra tarjeta de embarque en tu dispositivo y el precio es el de la ciudad en tu dispositivo y la de la ciudad en tu dispositivo y la de la ciudad y elegir el",
    "creation": "2019-02-27 00:15:36.671",
    "modification": "2019-03-25 16:06:22.71",
    "color": -16777216,
    "password": "",
    "type": "Note",
    "deleted": 0
  },
  {
    "id": 56,
    "title": "",
    "text": "List\n□ It's\n☑ ~Todo~\n□ no\n□ para\n□ y\n□ no\n□ no te\n□ no sé\n para estar",
    "creation": "2019-02-27 00:12:33.362",
    "modification": "2019-02-27 00:12:40.46",
    "color": -14043396,
    "password": "",
    "type": "Note",
    "deleted": 1
  },
  {
    "id": 55,
    "title": "Y",
    "text": "[]",
    "creation": "2019-02-27 00:08:36.187",
    "modification": "2019-02-27 00:08:36.194",
    "color": -14043396,
    "password": "",
    "type": "CheckList",
    "deleted": 1
  },
  {
    "id": 54,
    "title": "Ideas",
    "text": "[{\"a\":\"Markdown in preview dialog\",\"b\":false},{\"a\":\"Markdown in notes list\",\"b\":false}]",
    "creation": "2019-02-26 18:19:50.873",
    "modification": "2019-03-18 19:30:36.694",
    "color": -14043396,
    "password": "",
    "type": "CheckList",
    "deleted": 1
  },
  {
    "id": 53,
    "title": "ToDos It's here!",
    "text": "[{\"a\":\"It\\u0027s\",\"b\":false},{\"a\":\"Todo\",\"b\":true},{\"a\":\"no\",\"b\":false},{\"a\":\"no hay comentarios\",\"b\":false},{\"a\":\"para que lo bloqueen\",\"b\":true},{\"a\":\"no te lo envío a tu\",\"b\":false}]",
    "creation": "2019-02-25 19:17:15.152",
    "modification": "2019-03-01 09:09:05.854",
    "color": -11243910,
    "password": "",
    "type": "CheckList",
    "deleted": 1
  },
  {
    "id": 52,
    "title": "ToDos It's here!",
    "text": "[{\"a\":\"The\",\"b\":true},{\"a\":\"Here\",\"b\":false},{\"a\":\"It\\u0027s\",\"b\":true},{\"a\":\"Todo\",\"b\":true},{\"a\":\"no\",\"b\":true},{\"a\":\"y\",\"b\":false},{\"a\":\"no sé qué\",\"b\":true}]",
    "creation": "2019-02-25 19:17:15.152",
    "modification": "2019-02-27 18:49:14.283",
    "color": -14043396,
    "password": "",
    "type": "CheckList",
    "deleted": 1
  },
  {
    "id": 51,
    "title": "",
    "text": "Pensamiento \nViolas\nLavanda \nClavellina\n",
    "creation": "2019-02-25 01:26:48.015",
    "modification": "2019-02-25 01:30:09.097",
    "color": -7860657,
    "password": "",
    "type": "Note",
    "deleted": 0
  },
  {
    "id": 50,
    "title": "Mandado",
    "text": "[{\"a\":\"Leche\",\"b\":false},{\"a\":\"Cereal\",\"b\":true},{\"a\":\"Pan\",\"b\":true},{\"a\":\"Cafe\",\"b\":true}]",
    "creation": "2019-02-24 22:26:10.374",
    "modification": "2019-03-06 22:30:38.842",
    "color": -11243910,
    "password": "",
    "type": "CheckList",
    "deleted": 0
  }]</textarea>
		<button onclick="processData();">Process</button>

		<script type="text/javascript">
			
			function processData(){

				var data = document.getElementById("jsonData").value;

				if(data != ""){

					document.getElementById("jsonData").value = "";

					document.getElementById("container").innerHTML = "";

					var str = JSON.parse(data);

					for(var i = 0; i < str.length; i++) {
					    var obj = str[i];

					    var card = document.createElement("div");
						card.setAttribute('class', 'card');


						var p = document.createElement('p');
						var title = document.createTextNode(obj.title);

						var txt = ""
						if(obj.type == "Note"){
							txt = obj.text;
						}else{

							var finalT = "";

							var sstr = JSON.parse(obj.text);
							for(var j = 0; j < sstr.length; j++){
								
								if(sstr[j].b){
									finalT += '\u2714' + " " + sstr[j].a;
								}else{
									finalT += '\u2718' + " " + sstr[j].a;
								}
								
								finalT += '\n';
							}

							txt = finalT;

						}



						var text = document.createTextNode(txt);

						var tContainer = document.createElement("div");
						tContainer.setAttribute('class', 'card-title');	
						tContainer.appendChild(title);	

						p.appendChild(tContainer);
						//p.appendChild(document.createElement("br"));
						//p.appendChild(document.createElement("br"));				
						if(obj.type == "CheckList"){
							p.style = "white-space: pre-line;";
						}
						p.appendChild(text);

						var card_info = document.createElement("div");
						card_info.setAttribute('class', 'card-info');	
						card_info.appendChild(p);				

						
						card.appendChild(card_info);

						
						card.style.backgroundColor = VBColorToHEX(obj.color);
							
						var light = lightOrDark(VBColorToHEX(obj.color));

						if(light == 'dark'){
							card.style.color = "white";
						}else{
							card.style.color = "black";
						}
						

						document.getElementById('container').appendChild(card);
					}

					var grid = new PinterestGrid({
		                container: '.cards',
		                item: '.card',
		                gutter: 6,
		                delay: 10
		            });

		            window.addEventListener('resize', function() {
		                grid.init();
		            });

		            Array.from(document.querySelectorAll('.card img')).forEach(function(item) {
		                item.addEventListener('load', function() {
		                    grid.init();
		                    item.removeEventListener('load');
		                }, false);
		            });
				}
			

			}

			function VBColorToHEX(i) {
			    var bbggrr =  ("000000" + i.toString(16)).slice(-6);
			    var rrggbb = bbggrr.substr(4, 2) + bbggrr.substr(2, 2) + bbggrr.substr(0, 2);
			    return "#" + rrggbb;
			}

			function lightOrDark(color) {

			    // Variables for red, green, blue values
			    var r, g, b, hsp;
			    
			    // Check the format of the color, HEX or RGB?
			    if (color.match(/^rgb/)) {
			        // If HEX --> store the red, green, blue values in separate variables
			        color = color.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d+(?:\.\d+)?))?\)$/);
			        
			        r = color[1];
			        g = color[2];
			        b = color[3];
			    }else {
			      
			        // If RGB --> Convert it to HEX: http://gist.github.com/983661
			        color = +("0x" + color.slice(1).replace( 
			        color.length < 5 && /./g, '$&$&'));

			        r = color >> 16;
			        g = color >> 8 & 255;
			        b = color & 255;
			    }
			    
			    // HSP (Highly Sensitive Poo) equation from http://alienryderflex.com/hsp.html
			    hsp = Math.sqrt(
			    0.299 * (r * r) +
			    0.587 * (g * g) +
			    0.114 * (b * b)
			    );

			    // Using the HSP value, determine whether the color is light or dark
			    if (hsp>127.5) {
			        return 'light';
			    }else {
			        return 'dark';
			    }
			}

		</script>



		<div class="cards" id="container"></div>
	</div>



	<script src="pinterestgrid.js"></script>
    
</body>
</html>